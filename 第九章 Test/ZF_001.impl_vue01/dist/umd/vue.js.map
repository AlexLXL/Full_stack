{"version":3,"file":"vue.js","sources":["../../src/utils.js","../../src/observe/array.js","../../src/observe/dep.js","../../src/observe/index.js","../../src/state.js","../../src/compiler/parser.js","../../src/compiler/generate.js","../../src/compiler/index.js","../../src/vdom/patch.js","../../src/observe/schedule.js","../../src/observe/watcher.js","../../src/lifeCycle.js","../../src/init.js","../../src/vdom/index.js","../../src/render.js","../../src/global-api/index.js","../../src/index.js"],"sourcesContent":["export function isFunction(val) {\r\n    return typeof val === \"function\";\r\n}\r\n\r\nexport function isObject(val) {\r\n    return typeof val === \"object\" && val !== null;\r\n}\r\n\r\nexport function isArray(val) {\r\n    return Array.isArray(val);\r\n}\r\n\r\nlet callbacks = [];\r\nlet waiting = false;\r\nexport function nextTick(fn) {\r\n    callbacks.push(fn);\r\n    if (!waiting) {\r\n        Promise.resolve().then(flushCallbacks);\r\n        waiting = true;\r\n    }\r\n}\r\nfunction flushCallbacks() {\r\n    callbacks.forEach(fn => fn());\r\n    callbacks = [];\r\n    waiting = false;\r\n}\r\n\r\n// 第一次合并： {} {beforeCreate: fn} => {beforeCreate: [fn]}\r\n// 第二次合并:  {beforeCreate: [fn]} {beforeCreate: fn} => {beforeCreate: [fn, fn]}\r\nlet strategys = {}; // 存储所有策略\r\nlet lifeCycle = [\"beforeCreate\", \"created\", \"beforeMount\", \"Mounted\"];\r\nlifeCycle.forEach(hook => {\r\n    strategys[hook] = function(parentVal, childVal) {\r\n        if(childVal) {\r\n            if(parentVal) {\r\n                return parentVal.concat(childVal); // 看上面的第二次合并，parentVal已经是数组\r\n            }else {\r\n                if(isArray(childVal)) {\r\n                    return childVal\r\n                }\r\n                return [childVal];\r\n            }\r\n        }else {\r\n            return parentVal;\r\n        }\r\n    }\r\n})\r\n\r\n\r\nexport function mergeOptions(parentVal, childVal) {\r\n    const options = {};\r\n    // 合并全局属性和组件属性(options)\r\n    for(let key in parentVal) {\r\n        mergeFiled(key);\r\n    }\r\n\r\n    // 添加组件属性\r\n    for(let key in childVal) {\r\n        if(!parentVal.hasOwnProperty(key)) {\r\n            mergeFiled(key);\r\n        }\r\n    }\r\n\r\n    function mergeFiled(key) {\r\n        let strat = strategys[key];\r\n        if(strat) {\r\n            options[key] = strat(parentVal[key], childVal[key]); // 合并生命周期\r\n        }else {\r\n            options[key] = childVal[key] || parentVal[key]; // 合并data那些\r\n        }\r\n    }\r\n\r\n    return options;\r\n}","let oldArrayPrototype = Array.prototype;\r\n\r\nexport let arrayMethods = Object.create(oldArrayPrototype);\r\n\r\nlet methods = [\"push\", \"shift\", \"pop\", \"unshift\", \"reverse\", \"sort\", \"splice\"];\r\n\r\nmethods.forEach((method) => {\r\n    arrayMethods[method] = function(...args){\r\n        oldArrayPrototype[method].call(this, ...args);\r\n\r\n        // 监控新增的值\r\n        let inserted = null;\r\n        let ob = this.__ob__;\r\n        switch (method) {\r\n            case \"splice\":\r\n                inserted = args.slice(2);\r\n            case \"push\":\r\n            case \"unshift\":\r\n                inserted = args;\r\n                break;\r\n        }\r\n        if (inserted) ob.observeArray(inserted);\r\n        ob.dep.notify(); // 响应式原理之收集依赖之更新流程\r\n    }\r\n})","let id = 0;\r\n\r\nexport class Dep {\r\n    constructor() {\r\n        this.subs = [];\r\n        this.id = id++;\r\n    }\r\n\r\n    depend() {\r\n        Dep.target.addDep(this); // watcher添加dep\r\n    }\r\n    addSub(watcher) {\r\n        this.subs.push(watcher);\r\n    }\r\n    notify() {\r\n        this.subs.forEach(watcher => watcher.update())\r\n    }\r\n}\r\nDep.target = null;","import {isArray, isObject} from \"../utils\";\r\nimport {arrayMethods} from \"./array\";\r\nimport {Dep} from \"./dep\";\r\n\r\nexport function observe(value) {\r\n    if (value.__ob__) return;\r\n    if (!isObject(value)) return;\r\n\r\n    return new Observer(value);\r\n}\r\n\r\nclass Observer {\r\n    constructor(value) {\r\n        // 给对象添加dep(给数组添加值，给对象添加属性时调用该dep)\r\n        this.dep = new Dep();\r\n\r\n        // 1.标识值已经监控过\r\n        // 2.方便array.js里调用监控数组的方法\r\n        // 3.方便数组内的引用数据调用__ob__.dep更新页面\r\n        Object.defineProperty(value, \"__ob__\", {\r\n            value: this,\r\n            enumerable: false\r\n        })\r\n\r\n        if (isArray(value)) {\r\n            value.__proto__ = arrayMethods;\r\n            this.observeArray(value);\r\n        }else {\r\n            this.walk(value);\r\n        }\r\n    }\r\n\r\n    walk(data) {\r\n        // 监控对象\r\n        Object.keys(data).forEach((key) => {\r\n            defineReactive(data, key, data[key]);\r\n        })\r\n    }\r\n\r\n    observeArray(data) {\r\n        // 监控数组\r\n        data.forEach((item) => observe(item)); // 数组内的引用类型添加监控，[[], {}]\r\n    }\r\n}\r\n\r\nfunction defineReactive(obj, key, value) {\r\n    let childObj = observe(value); // 递归监控value\r\n    let dep = new Dep(); // // 给对象属性添加dep\r\n    Object.defineProperty(obj, key, {\r\n        get() {\r\n            if (Dep.target) {\r\n                dep.depend();\r\n                \r\n                if (childObj) {\r\n                    childObj.dep.depend();\r\n                    if (isArray(value)) {\r\n                        dependArray(value);\r\n                    }\r\n                }\r\n            }\r\n            return value;\r\n        },\r\n        set(newValue) {\r\n            if (newValue === value) return;\r\n            observe(newValue); // 新值加监控\r\n            value = newValue;\r\n            dep.notify();\r\n        }\r\n    })\r\n}\r\n\r\nfunction dependArray(value) { // 数组里的 引用类型 都收集依赖(更新watcher)\r\n    for(let i = 0; i < value.length;i++){\r\n        let current = value[i];\r\n        current.__ob__ && current.__ob__.dep.depend(); // 依赖收集\r\n        if(isArray(current)) {\r\n            dependArray(current);\r\n        }\r\n    }\r\n}","import {isFunction} from \"./utils\";\r\nimport {observe} from \"./observe/index.js\";\r\n\r\nexport function initState(vm) {\r\n    const opts = vm.$options;\r\n    \r\n    if (opts.data) {\r\n        initData(vm)\r\n    }\r\n}\r\n\r\nfunction initData(vm) {\r\n    let data = vm.$options.data;\r\n    data = vm._data = isFunction(data) ? data.call(vm) : data;\r\n    observe(data);\r\n    \r\n    for (let key in data) {\r\n        proxy(vm, key, \"_data\");\r\n    }\r\n    \r\n    console.log(\"添加监控后data:\", data);\r\n    // data.arr.push(3);\r\n    // console.log(vm.arr);\r\n    // vm.arr[1].push(3);\r\n    // vm.name = {a: 2};\r\n    // vm.name.a = 20;\r\n    // vm.arr.push({a: 100});\r\n    // vm.arr[3].a = 200;\r\n}\r\n\r\nfunction proxy(vm, key, source) {\r\n    Object.defineProperty(vm, key, {\r\n        get() {\r\n            return vm[source][key];\r\n        },\r\n        set(newValue) {\r\n            vm[source][key] = newValue;\r\n        }\r\n    })\r\n}","// 用\"html\".match(new RegExp(ncname))匹配\r\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // 匹配标签名，子模块aaa-bbb\r\n/*[\r\n    0: \"aa-bb\"\r\n    groups: undefined\r\n    index: 1\r\n    input: \"<aa-bb>2131</aa-bb>>\"\r\n    length: 1\r\n]*/\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; // 命名空间标签，aa:aa-xxx。很少用\r\n/*[\r\n    0: \"aa-bb\"\r\n    1: \"aa-bb\"\r\n    groups: undefined\r\n    index: 1\r\n    input: \"<aa-bb>2131</aa-bb>>\"\r\n    length: 2\r\n]*/\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 匹配<标签名和标签名，0: <aa:aa-xxx或<aa-aa, 1: aa:aa-xxx或aa-aa\r\n/*[\r\n    0: \"<aa-bb\"\r\n    1: \"aa-bb\"\r\n    groups: undefined\r\n    index: 0\r\n    input: \"<aa-bb>2131</aa-bb>\"\r\n    length: 2\r\n]*/\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性, 见下\r\n/*{\r\n    0: \"title = 123\"    // 完整字符串\r\n    1: \"title\"      // key\r\n    2: \"=\"          // 等号\r\n    3: undefined    // 双引号\r\n    4: undefined    // 单引号\r\n    5: \"123\"        // 无引号\r\n    groups: undefined\r\n    index: 0\r\n    input: \"title = 123></aa-bb>\"\r\n    length: 6\r\n}*/\r\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束, >或/>\r\n/*{\r\n    0: \"/>\"\r\n    1: \"/\"\r\n    groups: undefined\r\n    index: 0\r\n    input: \"/>32323\"\r\n    length: 2\r\n}*/\r\n// const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; // // 匹配文本, {{message}}\r\n/*{\r\n    0: \"{{message}}\"\r\n    length: 1\r\n}*/\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结束 0: </aa-bb>, 1: aa-bb\r\n/*{\r\n    0: \"</aa-bb>\"\r\n    1: \"aa-bb\"\r\n    groups: undefined\r\n    index: 0\r\n    input: \"</aa-bb>\"\r\n    length: 2\r\n}*/\r\n\r\n// 生成ast树\r\nexport function parserHTML(html) {\r\n    let stack = [];\r\n    let root = null;\r\n    function start(tagName, attrs) {\r\n        let parent = stack[stack.length - 1];\r\n        let element = createASTElement(tagName, attrs, parent);\r\n        if (root === null) {\r\n            root = element;\r\n        }\r\n\r\n        if (parent) {\r\n            element.parent = parent;\r\n            parent.children.push(element);\r\n        }\r\n\r\n        stack.push(element);\r\n    }\r\n    function text(chars) {\r\n        let parent = stack[stack.length - 1];\r\n        chars.replace(/\\s/g, \"\"); // 替换空格\r\n        if(chars) {\r\n            parent.children.push({\r\n                type: 2,\r\n                text:chars\r\n            })\r\n        }\r\n    }\r\n    function end(tagName) {\r\n        let endTag = stack.pop();\r\n        if(endTag.tag != tagName) {\r\n            console.log(\"标签出错\");\r\n        }\r\n    }\r\n    function advance(len) {\r\n        html = html.substring(len);\r\n    }\r\n    function parseStartTag() {\r\n        const start = html.match(startTagOpen);\r\n        if (start) {\r\n            // 匹配到开始标签\r\n            const match = {\r\n                tagName: start[1],\r\n                attrs: []\r\n            }\r\n            advance(start[0].length);\r\n\r\n            // 匹配属性\r\n            let end,\r\n                attr\r\n            while(!(end = html.match(startTagClose)) && (attr = html.match(attribute))) { // 顺序不能反\r\n                match.attrs.push({\r\n                    name: attr[1],\r\n                    value: attr[3] || attr[4] || attr[5]\r\n                })\r\n                advance(attr[0].length);\r\n            }\r\n            if (end) {\r\n                advance(end[0].length)\r\n            }\r\n\r\n            return match;\r\n            /*\r\n            {\r\n                tagName: div,\r\n                attrs: [\r\n                    {title: 123}\r\n                ]\r\n            }\r\n            */\r\n        }\r\n        return false;\r\n    }\r\n    function createASTElement(tag, attrs, parent) {\r\n        return {\r\n            tag,\r\n            attrs,\r\n            parent,\r\n            type: 1,\r\n            children: []\r\n        }\r\n    }\r\n\r\n    while(html) {\r\n        let index = html.indexOf(\"<\");\r\n        if (index === 0) {\r\n            // 开始标签\r\n            const startTagMatch = parseStartTag(html); // 拿到开始标签的名称和属性，开始构建ast\r\n            if (startTagMatch) {\r\n                start(startTagMatch.tagName, startTagMatch.attrs);\r\n                continue;\r\n            }\r\n            // 结束标签\r\n            let endTagMatch\r\n            if(endTagMatch = html.match(endTag)) {\r\n                end(endTagMatch[1]);\r\n                advance(endTagMatch[0].length)\r\n                continue;\r\n            }\r\n            break;\r\n        }\r\n        // 文本\r\n        if (index > 0) {\r\n            let chars = html.substring(0, index);\r\n            text(chars);\r\n            advance(chars.length);\r\n        }\r\n    }\r\n\r\n    return root;\r\n}","let defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; // 匹配文本, {{message}}\r\n/*{\r\n    0: \"{{message}}\"\r\n    length: 1\r\n}*/\r\n\r\nexport function generate(ast) {\r\n    // 2.处理子组件\r\n    let children = genChildren(ast);\r\n\r\n    // 1.处理第一层div\r\n    let code =\r\n        `_c(\"${ast.tag}\",\r\n            ${\r\n                ast.attrs.length ? genProps(ast.attrs) : \"undefined\"\r\n            }\r\n            ${\r\n                children ? `,${children}` : \"\"\r\n            }\r\n        )`;\r\n    return code\r\n}\r\n\r\nfunction genChildren(el) {\r\n    let children = el.children;\r\n    if (children) {\r\n        // 要分类讨论，1.普通文本 2.{{文本}} 3.子标签span/div\r\n        return children.map(item => gen(item)).join(\",\");\r\n    }\r\n    return false\r\n}\r\n\r\nfunction gen(el) {\r\n    if (el.type == 1) {\r\n        // 3.子标签span/div\r\n        return generate(el);\r\n    }else {\r\n        // 1.只有普通文本\r\n        let text = el.text;\r\n        if (!defaultTagRE.test(text)) return `_v(\"${text}\")`;\r\n        defaultTagRE.lastIndex = 0; // ★ /g正则调用test()和exec()lastIndex都会往后\r\n\r\n        //  2.普通文本 + {{文本}}\r\n        let lastIndex = 0;\r\n        let tokens = [];\r\n        let match;\r\n        while(match = defaultTagRE.exec(text)) {\r\n            // ★ exec和正则的/g要注意，/g会让 defaultTagRE的lastIndex 往后一位\r\n            // 如<p>aa {{bb}} cc {{dd}}</p>\r\n            // 第一次是匹配到aa {{bb}}\r\n            let index = match.index;\r\n            if (index > lastIndex) {\r\n                tokens.push(JSON.stringify(text.slice(lastIndex, index)));\r\n            }\r\n            tokens.push(`_s(${match[1].trim()})`);  // 1 -- name\r\n            lastIndex = index + match[0].length;    // 0 -- {{name}}\r\n        }\r\n        if (lastIndex < text.length) { // 匹配最后的普通文本bb， aa {{name}} bb\r\n            tokens.push(JSON.stringify(text.slice(lastIndex)));\r\n        }\r\n\r\n        return `_v(${tokens.join(\" + \")})`\r\n    }\r\n}\r\n\r\n\r\n\r\n/**\r\n * 生成属性字符串\r\n * @param attrs\r\n * @returns {string} 返回 {id:\"app\",style:{\"font-size\":\"18px\",\"color\":\"#ccc\"}}\r\n */\r\nfunction genProps(attrs) {\r\n    let str = \"\";\r\n\r\n    for (let i = 0; i < attrs.length; i++) {\r\n        let attr = attrs[i];\r\n        if (attr.name === \"style\") {\r\n            let styles = {}\r\n            attr.value.replace(/([^;:]+):([^;:]+)/g, function (...args) {\r\n                styles[args[1].trim()] = args[2].trim();\r\n            })\r\n            attr.value = styles;\r\n        }\r\n        str += `${attr.name}:${JSON.stringify(attr.value)},`\r\n    }\r\n\r\n    return `{${str.slice(0, -1)}}`;\r\n}\r\n/*\r\n* replace方法返回的arcgument\r\n* {\r\n*   0: \"color:123\"\r\n*   1: \"color\"\r\n*   2: \"123\"\r\n*   3: 0\r\n*   4: \"color:123;color:123\"\r\n*   length: 5\r\n* }\r\n*\r\n* */\r\n\r\n\r\n","import {parserHTML} from \"./parser\";\r\nimport {generate} from \"./generate\";\r\n\r\nexport function compilerToFunction(template) {\r\n    console.log(\"template:\", template);\r\n\r\n    let ast = parserHTML(template);\r\n    console.log(\"ast:\", ast);\r\n\r\n    let code = generate(ast);\r\n    console.log(\"code:\", code);\r\n\r\n    let render = new Function(`with(this) {return ${code}}`);\r\n    console.log(\"render:\", render.toString());\r\n\r\n    return render;\r\n}\r\n\r\n/*\r\n示例:AST格式\r\n\r\n{\r\nparent: undefined\r\ntag: \"div\"\r\ntype: 1\r\nattrs: Array(2)\r\n    0: {name: \"id\", value: \"app\"}\r\n    1: {name: \"style\", value: \"font-size: 18px; color: #ccc\"}\r\n    length: 2\r\n    __proto__: Array(0)\r\nchildren: Array(2)\r\n    0: {type: 2, text: \" aa {{name}} bb \"}\r\n    1: {tag: \"span\", attrs: Array(0), parent: {…}, type: 1, children: Array(1)}\r\n    length: 2\r\n    __proto__: Array(0)\r\n}\r\n*/","export function patch(oldVnode, vnode) {\r\n    const parentNode = oldVnode.parentNode;\r\n    const elm = createElm(vnode);\r\n    parentNode.insertBefore(elm, oldVnode.nextSibing);\r\n    parentNode.removeChild(oldVnode);\r\n    return elm;\r\n}\r\n\r\nfunction createElm(vnode) {\r\n    let {tag, data, children, text, vm} = vnode;\r\n\r\n    if(typeof tag === \"string\"){\r\n        vnode.el = document.createElement(tag);\r\n        updateProperties(vnode.el, data);\r\n        children.forEach(child => {\r\n            vnode.el.appendChild(createElm(child));\r\n        })\r\n    }else {\r\n        vnode.el = document.createTextNode(text);\r\n    }\r\n\r\n    return vnode.el;\r\n}\r\n\r\nfunction updateProperties(el, props={}) {\r\n    // 边界问题: 样式\r\n    for(let key in props) {\r\n        el.setAttribute(key, props[key]);\r\n    }\r\n}","import {nextTick} from \"../utils\";\r\n\r\nlet has = {};\r\nlet queue = [];\r\nlet pending = false;\r\n\r\nexport function queueWatcher(watcher) {\r\n    let id = watcher.id;\r\n    if (has[id] == null) {\r\n        has[id] = true;\r\n        queue.push(watcher);\r\n    }\r\n    if (!pending) {\r\n        nextTick(flushSchedulerQueue); // 修改值的也是放到微任务队列里\r\n        pending = true;\r\n    }\r\n}\r\n\r\nfunction flushSchedulerQueue() {\r\n    queue.forEach(watcher => watcher.run());\r\n    queue = [];\r\n    has = {};\r\n    pending = false;\r\n}","import {Dep} from \"./dep\";\r\nimport {queueWatcher} from \"./schedule\";\r\n\r\nlet id = 0;\r\n\r\nexport class Watcher {\r\n    constructor(vm, fn, cb, options) {\r\n        this.vm = vm;\r\n        this.fm = fn;\r\n        this.cb = cb;\r\n        this.options = options; // 是否渲染watcher\r\n        this.id = id++;\r\n        this.depIds = new Set();\r\n        this.deps = [];\r\n        this.getter = fn;\r\n\r\n        this.get();\r\n    }\r\n\r\n    get() {     // 初始化\r\n        Dep.target = this; // window.target = watcher\r\n        this.getter();\r\n        Dep.target = null;\r\n    }\r\n    run() {  // 真正更新\r\n        // console.log(\"run执行次数\");\r\n        this.get();\r\n    }\r\n    update() { // 更新\r\n        // this.get();\r\n        queueWatcher(this); // 缓存更新，调度watcher\r\n    }\r\n    addDep(dep) {\r\n        let did = dep.id;\r\n        if(!this.depIds.has(did)) { // 这里实现dep.ids的去重和watcher.deps去重\r\n            this.depIds.add(did);\r\n            this.deps.push(dep); // 保存id并让watcher记住dep\r\n            dep.addSub(this);\r\n        }\r\n    }\r\n}","import {patch} from \"./vdom/patch\";\r\nimport {Watcher} from \"./observe/watcher\";\r\n\r\nexport function mountComponent(vm) {\r\n    // let vnode = vm._render();\r\n    // console.log(\"vnode:\", vnode);\r\n    // vm._update(vnode);\r\n\r\n    // 组件更新函数\r\n    let updateComponent = () => {\r\n        vm._update(vm._render()); // render -> vnode -> real DOM\r\n    }\r\n\r\n    callHook(vm, \"beforeCreate\");\r\n    new Watcher(vm, updateComponent, () => { // render -> getter -> watcher\r\n        callHook(vm, \"created\");\r\n    }, true);\r\n\r\n    callHook(vm, \"mounted\");\r\n}\r\n\r\nexport function lifCycleMixin(Vue) {\r\n    Vue.prototype._update = function (vnode) {\r\n        const vm = this;\r\n        vm.$el = patch(vm.$el, vnode);\r\n    }\r\n}\r\n\r\nexport function callHook(vm, hook) {\r\n    let handlers = vm.$options[hook];\r\n    handlers && handlers.forEach(item => {\r\n        item.call(this); // 声明周期的this永远指向实例\r\n    })\r\n}","import {initState} from \"./state\";\r\nimport {compilerToFunction} from \"./compiler\";\r\nimport {callHook, mountComponent} from \"./lifeCycle\";\r\nimport {mergeOptions, nextTick} from \"./utils\";\r\n\r\nexport function initMixin(Vue) {\r\n    Vue.prototype._init = function (options) {\r\n        const vm = this;\r\n        // vm.$options = options;\r\n        vm.$options = mergeOptions(vm.constructor.options, options); // 全局属性和组件属性合并\r\n\r\n        initState(vm);\r\n\r\n        if (vm.$options.el) {\r\n            vm.$mount(vm.$options.el);\r\n        }\r\n    }\r\n\r\n    Vue.prototype.$mount = function (el) {\r\n        const vm = this;\r\n        const opts = vm.$options;\r\n        el = document.querySelector(el);\r\n        vm.$el = el;\r\n\r\n        if (!opts.render) {\r\n            let template = opts.template;\r\n            if (!opts.template) {\r\n                template = el.outerHTML;\r\n            }\r\n            let render = compilerToFunction(template);\r\n            opts.render = render;\r\n        }\r\n\r\n        mountComponent(vm);\r\n    }\r\n\r\n    Vue.prototype.$nextTick = nextTick;\r\n}\r\n\r\n/*\r\n示例:render函数\r\n\r\nfunction render() {\r\n  with(this) {\r\n    return _c('div', {\r\n      attrs: {\r\n        \"id\": \"app\"\r\n      }\r\n    }, [_v(\"aa \" + _s(msg) + \" cc \"), _c('p', [_v(\"cc\")])])\r\n  }\r\n}\r\n*/\r\n","export function createElement(vm, tag, data={},...children) {\r\n    return vnode(vm, tag, data, children, data.key, undefined);\r\n}\r\n\r\nexport function createText(vm, text) {\r\n    return vnode(vm, undefined, undefined, undefined, undefined, text);\r\n}\r\n\r\nfunction vnode(vm, tag, data, children, key, text) { // key用于之后做diff\r\n    return {\r\n        vm,\r\n        tag,\r\n        data,\r\n        children,\r\n        key,\r\n        text\r\n    }\r\n}","import {isObject} from \"./utils\";\r\nimport {createElement, createText} from \"./vdom\";\r\n\r\nexport function renderMixin(Vue) {\r\n    Vue.prototype._render = function() {\r\n        const vm = this;\r\n        let {render} = vm.$options;\r\n        let vnode = render.call(vm);\r\n        return vnode;\r\n    }\r\n    Vue.prototype._c = function() {\r\n        const vm = this;\r\n        return createElement(vm, ...arguments);\r\n    }\r\n    Vue.prototype._v = function(text) { // 创建文本的虚拟节点\r\n        const vm = this;\r\n        return createText(vm, text);\r\n    }\r\n    Vue.prototype._s = function(val) {\r\n        if(isObject(val)) return JSON.stringify(val);\r\n        return val;\r\n    }\r\n}","// 合并 全局属性 到组件\r\nimport {mergeOptions} from \"../utils\";\r\n\r\nexport function initGlobalAPI(Vue) {\r\n    Vue.options = {}; // 全局属性(组件初始化时，添加这些属性)\r\n    Vue.mixin = function (options) {\r\n        this.options = mergeOptions(this.options, options);\r\n        return this;\r\n    }\r\n    Vue.component = function(options) {}\r\n    Vue.filter = function(options) {}\r\n    Vue.directive = function(options) {}\r\n}","import {initMixin} from \"./init\";\r\nimport {renderMixin} from \"./render\";\r\nimport {lifCycleMixin} from \"./lifeCycle\";\r\nimport {initGlobalAPI} from \"./global-api\";\r\n\r\nfunction Vue(option) {\r\n    this._init(option);\r\n}\r\n\r\n// vue内部的扩展方法\r\ninitMixin(Vue);\r\nrenderMixin(Vue);\r\nlifCycleMixin(Vue);\r\n\r\n// vue外部扩展方法(给用户使用)\r\ninitGlobalAPI(Vue);\r\n\r\nexport default Vue;\r\n"],"names":["isFunction","val","isObject","isArray","Array","callbacks","waiting","nextTick","fn","push","Promise","resolve","then","flushCallbacks","forEach","strategys","lifeCycle","hook","parentVal","childVal","concat","mergeOptions","options","key","mergeFiled","hasOwnProperty","strat","oldArrayPrototype","prototype","arrayMethods","Object","create","methods","method","args","call","inserted","ob","__ob__","slice","observeArray","dep","notify","id","Dep","constructor","subs","depend","target","addDep","addSub","watcher","update","observe","value","Observer","defineProperty","enumerable","__proto__","walk","data","keys","defineReactive","item","obj","childObj","get","dependArray","set","newValue","i","length","current","initState","vm","opts","$options","initData","_data","proxy","console","log","source","ncname","qnameCapture","startTagOpen","RegExp","attribute","startTagClose","endTag","parserHTML","html","stack","root","start","tagName","attrs","parent","element","createASTElement","children","text","chars","replace","type","end","pop","tag","advance","len","substring","parseStartTag","match","attr","name","index","indexOf","startTagMatch","endTagMatch","defaultTagRE","generate","ast","genChildren","code","genProps","el","map","gen","join","test","lastIndex","tokens","exec","JSON","stringify","trim","str","styles","compilerToFunction","template","render","Function","toString","patch","oldVnode","vnode","parentNode","elm","createElm","insertBefore","nextSibing","removeChild","document","createElement","updateProperties","child","appendChild","createTextNode","props","setAttribute","has","queue","pending","queueWatcher","flushSchedulerQueue","run","Watcher","cb","fm","depIds","Set","deps","getter","did","add","mountComponent","updateComponent","_update","_render","callHook","lifCycleMixin","Vue","$el","handlers","initMixin","_init","$mount","querySelector","outerHTML","$nextTick","undefined","createText","renderMixin","_c","arguments","_v","_s","initGlobalAPI","mixin","component","filter","directive","option"],"mappings":"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"}