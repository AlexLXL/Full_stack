## 1. rollup实战

- rollupjs是下一代ES模块捆绑器

### 1.1 安装依赖

```
npm i @babel/core @babel/preset-env  @rollup/plugin-commonjs @rollup/plugin-node-resolve @rollup/plugin-typescript lodash rollup rollup-plugin-babel postcss rollup-plugin-postcss rollup-plugin-terser tslib typescript rollup-plugin-serve rollup-plugin-livereload -D
```

### 1.2 初次使用

#### 1.2.1 rollup.config.js

rollup.config.js

```
export default {
    input:'src/main.js',
    output:{
        file:'dist/bundle.cjs.js',//输出文件的路径和名称
        format:'cjs',//五种输出格式：amd/es6/iife/umd/cjs
        name:'bundleName'//当format为iife和umd时必须提供，将作为全局变量挂在window下
    }
}
```

#### 1.2.2 src\main.js

src\main.js

```
console.log('hello');
```

#### 1.2.3 package.json

package.json

```
{
 "scripts": {
    "build": "rollup --config"
  },
}
```

#### 1.2.4 dist\index.html

dist\index.html

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>rollup</title>
</head>
<body>
    <script src="bundle.cjs.js"></script>
</body>
</html>
```

### 1.3 支持babel

#### 1.3.1 安装依赖

```
npm install rollup-plugin-babel @babel/core @babel/preset-env --save-dev
```

#### 1.3.2 src\main.js

```
let sum = (a,b)=>{
    return a+b;
}
let result = sum(1,2);
console.log(result);
```

#### 1.3.3 .babelrc

.babelrc

```
{
    "presets": [
       [
        "@babel/env",
        {
            "modules":false
        }
       ]
    ]
}
```

#### 1.3.4 rollup.config.js

rollup.config.js

```
+import babel from 'rollup-plugin-babel';
export default {
    input:'src/main.js',
    output:{
        file:'dist/bundle.cjs.js',//输出文件的路径和名称
        format:'cjs',//五种输出格式：amd/es6/iife/umd/cjs
        name:'bundleName'//当format为iife和umd时必须提供，将作为全局变量挂在window下
    },
+   plugins:[
+       babel({
+           exclude:"node_modules/**"
+       })
+   ]
}
```





